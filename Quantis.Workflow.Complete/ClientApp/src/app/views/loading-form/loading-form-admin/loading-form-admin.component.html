<div *ngIf='loading' id="loader" class="text-center">
  <span class="fa fa-spin fa-spinner fa-3x text-primary"></span>
</div>

<!-- FORM TABLE CHOSEN VIEW ADMINISRATOR -->
<div>
<div class="container mb-5">
  <div class="row justify-content-center">
    <div class="col-sm-12 text-center">
      <h2>{{title}}</h2>
    </div>
    <div class="col-sm-7">
      <form [formGroup]="myInputForm" novalidate (ngSubmit)="save(myInputForm)">
          <div formArrayName="valories">
            <div *ngFor="let language of myInputForm.controls.valories.controls; let i=index" class="panel panel-default" >
              <div *ngIf="arrayFormElements.length > 0 && arrayFormElements[i].type=='time'" class="p-3 bg-white panel-body" [formGroupName]="i">
                  <div class="row" id="divDate">
                    <div class="col-sm-12">
                      <mat-label>{{arrayFormElements[i].name}}</mat-label>
                    </div>
                    <div class="col-sm-6">
                      <mat-form-field appearance="outline">
                        <mat-label>min Date</mat-label>
                        <input matInput [(ngModel)]="minDate[i]" [matDatepicker]="pickerb" [max]="maxDate[i]" class="form-control"   formControlName="valoreMin" >
                        <mat-datepicker-toggle matSuffix [for]="pickerb"></mat-datepicker-toggle>
                        <mat-datepicker #pickerb></mat-datepicker>
                      </mat-form-field>
                    </div>
                    <div class="col-sm-6">  
                      <mat-form-field appearance="outline">
                        <mat-label>max Date</mat-label>
                        <input matInput [(ngModel)]="maxDate[i]"  [min]="minDate[i]"  [matDatepicker]="pickera" class="form-control"   formControlName="valoreMax" >
                        <mat-datepicker-toggle matSuffix [for]="pickera"></mat-datepicker-toggle>
                        <mat-datepicker #pickera></mat-datepicker>
                      </mat-form-field>
                    </div>
                  </div>
              </div>
              <div *ngIf="arrayFormElements.length > 0 && arrayFormElements[i].type!='time'" class="p-3 bg-white panel-body" [formGroupName]="i">
                <div class="row">
                    <div class="col-sm-12">
                        <mat-label>{{arrayFormElements[i].name}}</mat-label>
                    </div>
                    <div class="col-sm-6">
                      <mat-form-field  appearance="outline">
                        <mat-label>inserisci numero minimo</mat-label>
                        <input matInput [max]="numeroMax[i]" [(ngModel)]="numeroMin[i]" type="number" placeholder="inserisci numero minimo" class="form-control"   formControlName="valoreMin">
                      </mat-form-field>
                    </div>
                    <div class="col-sm-6">
                      <mat-form-field  appearance="outline">
                        <mat-label>inserisci numero massimo</mat-label>
                        <input matInput [min]="numeroMin[i]" [(ngModel)]="numeroMax[i]" type="number" placeholder="inserisci numero massimo" class="form-control"   formControlName="valoreMax">
                      </mat-form-field>
                    </div>
                </div>
              </div>
            </div>
          </div>

          <div *ngIf="erroriArray.length>0">
            <p style="color:red; font-size:16px">{{erroriArray[0]}} </p>
          </div> 

          <div class="row">
            <div formArrayName="campiConfronto" class="panel panel-default">
                <div *ngFor="let language of myInputForm.controls.campiConfronto.controls; let i=index" class="panel-body" [formGroupName]="i" >
                  <div  class="form-group col-xs-3">
                      <mat-form-field appearance="outline">
                        <mat-select placeholder="campo 1"  formControlName="campo1" (selectionChange)="filtraElementi($event.value,i)" disableRipple>
                          <mat-option [value]="defaultFont[0].campo1" selected="selected">{{defaultFont[0].campo1.Name}}</mat-option>
                              
                          <mat-option *ngFor="let element of arrayFormElements " [value]="element" >{{element.name}}</mat-option>
                          
                        </mat-select>
                      </mat-form-field>
                  </div>

                  <div  class="form-group col-xs-3">
                    <mat-form-field appearance="outline">
                      <mat-select placeholder="confronto" formControlName="segno" disableRipple>
                        <mat-option *ngFor="let element of confronti " [value]="element">{{element}}</mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                
                  <div class="form-group col-xs-3">
                    <mat-form-field appearance="outline">
                      <mat-select    formControlName="campo2" disableRipple [disabled]="((arraySecondo[i]!=null && arraySecondo[i].length==0)||(arraySecondo[i]==null))" placeholder="campo 2">
                          <mat-option [value]="defaultFont[0].campo2" selected="selected">{{defaultFont[0].campo2.Name}}</mat-option>  
                        <mat-option *ngFor="let element of arraySecondo[i]" [value]="element" >{{element.name}}</mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
    
                  <span class="glyphicon glyphicon-remove pull-right" *ngIf="myInputForm.controls.valories.controls.length > 1" (click)="removeComparisonForm(i)"></span>
                </div>
              </div>
            </div>  
          <div class="row mb-3 align-items-center pt-3">
            <div class="col-sm-5">
              <div class="form-check form-check-inline" bis_skin_checked="1">
                <input class="form-check-input" type="checkbox" formControlName="termsCheck" value="true">
                <label class="form-check-label" for="inline-checkbox1">Dati non pervenuti</label>
              </div>
              </div>
            <div class="col-sm-5 offset-sm-2 text-right">
              <button type="submit" class="btn btn-primary" [disabled]="!myInputForm.valid">
                <span *ngIf="loading" class="fa fa-spinner fa-spin"></span>Salva
              </button>
              <a [routerLink]="['/loading-form/admin']" class="btn btn-info text-white">Annulla</a>
            </div>
          </div>
        </form>
    </div>
  </div>
</div>
</div>